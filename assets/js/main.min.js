$(document).ready(function() {
    if (document.querySelector("#activities-gallery") !== null) {
        var leadTile = 0;
        //index of the first tile in the set of three displayed.
        var jMobileTiles = $(".smallTile:not(.blank-tile)");
        //array of all real tiles
        var jTiles = $(".smallTile");
        //array of all tiles
        var mobileTileIndex = 0;
        function displayTiles(indexOfFirst) {
            //hide all tiles
            $(".smallTile").hide();
            //display the proper three tiles 
            for (var i = 0; i < jTiles.length; i++) {
                if (i >= indexOfFirst && i < indexOfFirst + 3) {
                    $(".smallTile").eq(i).show();
                }
            }
        }
        //hide all tiles after the first three
        displayTiles(leadTile);
        //when the right arrow is clicked
        $("#rightArrow").click(function() {
            if (leadTile + 3 < jTiles.length) {
                leadTile += 3;
            }
            displayTiles(leadTile);
        });
        //when the left arrow is clicked
        $("#leftArrow").click(function() {
            if (leadTile >= 3) {
                leadTile -= 3;
            }
            displayTiles(leadTile);
        });
        //when small a small tile is clicked, display the it in the main tile
        $(".smallTile").click(function() {
            //make the dark border of the selected tile lighter
            $(".selected").removeClass("selected");
            //make the newly selected tile's border darker
            $(this).addClass("selected");
            $("#mainTile").html($(this).find("#tileContent").html());
        });
        //when the right mobile arrow is clicked
        $("#right-mobile-arrow").click(function() {
            //if the index is out of bounds to the right,
            if (mobileTileIndex >= jMobileTiles.length - 1) {
                mobileTileIndex = 0;
            } else {
                mobileTileIndex++;
            }
            $("#mainTile").html($(jMobileTiles[mobileTileIndex]).find("#tileContent").html());
        });
        //when the right mobile arrow is clicked
        $("#left-mobile-arrow").click(function() {
            //if the index is out of bounds to the left,
            if (mobileTileIndex == 0) {
                //loop back to the last image
                mobileTileIndex = jMobileTiles.length - 1;
            } else {
                mobileTileIndex--;
            }
            $("#mainTile").html($(jMobileTiles[mobileTileIndex]).find("#tileContent").html());
        });
    }
});

$(document).ready(function() {
    $(".eventRow").click(function() {
        //make sure there is something to expand
        if ($(this).find("div.dCircle").length > 0) {
            return;
        }
        //collapse or expand the div
        var collapsed = $(this).find("div.eventDescription").html();
        if (collapsed.indexOf("...") > 0) {
            collapsed = collapsed.replace("...", "");
        } else {
            collapsed += "...";
        }
        $(this).find("div.eventDescription").html(collapsed);
        //collapse or expand the div
        $(this).find("div.collapsed-text").slideToggle("medium");
        //toggle the class
        var sign = $(this).find("div.circle").find("div.sign");
        if (sign.attr("class") == "sign collapsed") {
            sign.attr("class", "sign expanded");
            sign.html("-");
        } else {
            sign.attr("class", "sign collapsed");
            sign.html("+");
        }
    });
});

$(document).ready(function() {
    if (document.querySelector(".gallery-container") !== null) {
        var jTiles = $(".small-tile");
        //array of all 'tile' thumbnails
        var leadTile = 0;
        //the first tile in the row of 4 that is to be displayed
        //initialize the gallery
        displayTiles(leadTile);
        /**
         * Function to display the next four tiles starting at indexOfFirst
         */
        function displayTiles(indexOfFirst) {
            //hide all tiles
            $(".small-tile").hide();
            $("#gallery-caption").hide();
            //if the tiles are visible, but no arrows, show all tiles
            if ($("#thumbnail-container").css("display") == "block" && $(".gallery-arrow").css("display") == "none") {
                $(".small-tile").show();
            }
            //display the proper three tiles 
            for (var i = 0; i < jTiles.length; i++) {
                if (i >= indexOfFirst && i < indexOfFirst + 4) {
                    $(".small-tile").eq(i).show();
                }
            }
        }
        //if the right arrow is pressed
        $("#right-arrow").click(function() {
            if (leadTile + 4 < jTiles.length) {
                leadTile++;
                displayTiles(leadTile);
            }
        });
        //if the left arrow is pressed
        $("#left-arrow").click(function() {
            if (leadTile > 0) {
                leadTile--;
                displayTiles(leadTile);
            }
        });
        //when a thumbnail tile is clicked
        $(".small-tile").click(function() {
            $("#main-tile").html($(this).attr("data-value"));
            //check for a caption
            if ($(this).attr("data-value").indexOf('alt="') > 0) {
                var description = $(this).attr("data-value").substring($(this).attr("data-value").indexOf('alt="') + 5);
                description = description.substring(0, description.indexOf('"'));
                $("#gallery-caption").html(description);
                $("#gallery-caption").show();
            } else {
                $("#gallery-caption").hide();
            }
        });
        /********Code for mobile view of gallery***********/
        //handle view change from medium to large
        enquire.register("screen and (min-width : 992px)", {
            match: function() {
                displayTiles(0);
                leadTile = 0;
            }
        });
        //handle view change from large to medium
        enquire.register("screen and (max-width : 992px)", {
            match: function() {
                $(".small-tile").show();
            }
        });
        $("#right-mobile-arrow").click(function() {
            //if we are not out of bounds to the right
            leadTile = leadTile + 1 >= jTiles.length ? 0 : leadTile + 1;
            //show the next image
            $("#main-tile").html($(jTiles[leadTile]).attr("data-value"));
            $("#gallery-caption").hide();
        });
        $("#left-mobile-arrow").click(function() {
            //if we are not out of bounds to the left
            leadTile = leadTile - 1 < 0 ? jTiles.length - 1 : leadTile - 1;
            //show the next image
            $("#main-tile").html($(jTiles[leadTile]).attr("data-value"));
            $("#gallery-caption").hide();
        });
    }
});

$(document).ready(function() {
    if (document.querySelector("#inner-nav") !== null) {
        function toggleMenu() {
            //toggle the menu/home text
            $("#rNavHome").find("a").text() == "menu" ? $("#rNavHome").find("a").text("home") : $("#rNavHome").find("a").text("menu");
            //show the links
            if ($("#rNavDivider").css("display") != "none") {
                $("#rNavTriangle").slideToggle(200);
            }
            $("#rNavLinks").slideToggle(200);
        }
        function initializeMenu() {
            //show the menu icon
            $("#menuIcon").show();
            //hide the links
            $("#rNavLinks").hide();
            $("#rNavTriangle").hide();
            //show the menu text
            $("#rNavHome").find("a").text("menu");
        }
        initializeMenu();
        $("#menuIcon").click(function() {
            toggleMenu();
        });
    }
});

(function() {
    var nav = document.querySelector(".department-nav"), state = false;
    if (nav) {
        var more = nav.querySelector(".department-nav__more");
        showMore();
        more.addEventListener("click", function(e) {
            Array.prototype.forEach.call(document.querySelectorAll(".next-line"), function(element) {
                element.style.display = state ? "none" : "block";
            });
            nav.style.height = state ? "50px" : "auto";
            state = !state;
            e.preventDefault();
        });
        window.addEventListener("resize", showMore);
    }
    function showMore() {
        var moreThanOneLine = hasMoreThanOneLine();
        if (moreThanOneLine) {
            $(nav).addClass("department-nav--more-lines");
        } else {
            $(nav).removeClass("department-nav--more-lines");
        }
    }
    function hasMoreThanOneLine() {
        var navItems = nav.querySelectorAll(".navbar-collapse li"), numItems = navItems.length, moreThanOneLine = false;
        $(navItems).removeClass("next-line").css("display", "");
        for (var i = 0; i < numItems; i++) {
            moreThanOneLine = moreThanOneLine || navItems[i].offsetTop > 0;
            if (moreThanOneLine) {
                $(navItems[i]).addClass("next-line");
            }
        }
        nav.style.height = "50px";
        state = false;
        return moreThanOneLine;
    }
})();